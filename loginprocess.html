<?php
    include('connectiondb.php');
    session_start();

    $loginResult = null; // Inisialisasi $loginResult untuk mengelakkan Undefined variable

    if (isset($_POST['login'])) {
        $email = $_POST['email'];
        $password = $_POST['password'];
        $email = mysqli_real_escape_string($conn, $email);
        $password = mysqli_real_escape_string($conn, $password);

        $loginQuery = "SELECT * FROM user WHERE email = '$email' AND password = '$password'";
        $loginResult = mysqli_query($conn, $loginQuery);
    }

    if ($loginResult && mysqli_num_rows($loginResult) > 0) {
        $loginRow = mysqli_fetch_assoc($loginResult);
        $_SESSION['email'] = $email;
        $_SESSION['user_name'] = $loginRow['user_name'];
        $_SESSION['password'] = $password;

        header('Location:home.php');
        exit();
    } else {
        echo "<script>
                alert('Email or Password is incorrect');
                window.location.href = 'login.php';
            </script>";
    }

    mysqli_close($conn);
?>
